# Serverless Conan æ¶æ„è¯´æ˜

## ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Conan å®¢æˆ·ç«¯                              â”‚
â”‚                  (å¼€å‘è€…çš„æœ¬åœ°æœºå™¨)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ HTTPS
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Amazon API Gateway                            â”‚
â”‚                   (RESTful API å…¥å£)                             â”‚
â”‚  - Conan v1 API Routes (/v1/*)                                  â”‚
â”‚  - Conan v2 API Routes (/v2/*)                                  â”‚
â”‚  - è®¤è¯å’Œæˆæƒ                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ è§¦å‘
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AWS Lambda                                   â”‚
â”‚                  (Express.js åº”ç”¨)                               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  - åŒ…æœç´¢é€»è¾‘                                       â”‚         â”‚
â”‚  â”‚  - åŒ…ä¸Šä¼ /ä¸‹è½½ URL ç”Ÿæˆ                             â”‚         â”‚
â”‚  â”‚  - ç”¨æˆ·è®¤è¯                                         â”‚         â”‚
â”‚  â”‚  - å…ƒæ•°æ®ç®¡ç†                                       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â”‚                      â”‚
        â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Amazon DynamoDB â”‚    â”‚         Amazon S3                    â”‚
â”‚                  â”‚    â”‚                                      â”‚
â”‚  ğŸ“Š Tables:      â”‚    â”‚  ğŸ“¦ Buckets:                         â”‚
â”‚                  â”‚    â”‚                                      â”‚
â”‚  1. Packages     â”‚    â”‚  - Conan åŒ…æ–‡ä»¶ (.tgz)               â”‚
â”‚     Metadata     â”‚    â”‚  - conanfile.py                      â”‚
â”‚     - packageId  â”‚    â”‚  - conanmanifest.txt                 â”‚
â”‚     - name       â”‚    â”‚  - conan_sources.tgz                 â”‚
â”‚     - version    â”‚    â”‚  - äºŒè¿›åˆ¶åŒ…                          â”‚
â”‚     - user       â”‚    â”‚                                      â”‚
â”‚     - channel    â”‚    â”‚  ç»“æ„:                                â”‚
â”‚     - files[]    â”‚    â”‚  {packageId}/                        â”‚
â”‚                  â”‚    â”‚    â”œâ”€â”€ conanfile.py                  â”‚
â”‚  2. Users        â”‚    â”‚    â”œâ”€â”€ conanmanifest.txt             â”‚
â”‚     - username   â”‚    â”‚    â”œâ”€â”€ conan_export.tgz              â”‚
â”‚     - password   â”‚    â”‚    â””â”€â”€ packages/                     â”‚
â”‚     - token      â”‚    â”‚        â””â”€â”€ {package_hash}/...        â”‚
â”‚     - role       â”‚    â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ•°æ®æµ

### 1. åŒ…ä¸Šä¼ æµç¨‹

```
Conan Client                API Gateway              Lambda                  DynamoDB              S3
     â”‚                           â”‚                      â”‚                       â”‚                  â”‚
     â”‚ 1. POST upload_urls       â”‚                      â”‚                       â”‚                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                       â”‚                  â”‚
     â”‚                           â”‚ 2. è°ƒç”¨ Lambda        â”‚                       â”‚                  â”‚
     â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                  â”‚
     â”‚                           â”‚                      â”‚ 3. ç”Ÿæˆ S3 é¢„ç­¾å URL  â”‚                  â”‚
     â”‚                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
     â”‚                           â”‚                      â”‚                       â”‚                  â”‚
     â”‚                           â”‚                      â”‚ 4. ä¿å­˜åŒ…å…ƒæ•°æ®         â”‚                  â”‚
     â”‚                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
     â”‚                           â”‚                      â”‚                       â”‚                  â”‚
     â”‚                           â”‚ 5. è¿”å›ä¸Šä¼  URLs      â”‚                       â”‚                  â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                  â”‚
     â”‚                                                  â”‚                       â”‚                  â”‚
     â”‚ 6. ç›´æ¥ä¸Šä¼ æ–‡ä»¶åˆ° S3                              â”‚                       â”‚                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                                                                                             â”‚
     â”‚ 7. ä¸Šä¼ å®Œæˆ                                                                                 â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
```

### 2. åŒ…ä¸‹è½½æµç¨‹

```
Conan Client                API Gateway              Lambda                  DynamoDB              S3
     â”‚                           â”‚                      â”‚                        â”‚                 â”‚
     â”‚ 1. GET download_urls      â”‚                      â”‚                        â”‚                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                        â”‚                 â”‚
     â”‚                           â”‚ 2. è°ƒç”¨ Lambda        â”‚                        â”‚                 â”‚
     â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                 â”‚
     â”‚                           â”‚                      â”‚ 3. æŸ¥è¯¢åŒ…å…ƒæ•°æ®          â”‚                 â”‚
     â”‚                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
     â”‚                           â”‚                      â”‚                        â”‚                 â”‚
     â”‚                           â”‚                      â”‚ 4. åŒ…ä¿¡æ¯               â”‚                 â”‚
     â”‚                           â”‚                      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
     â”‚                           â”‚                      â”‚                        â”‚                 â”‚
     â”‚                           â”‚                      â”‚ 5. ç”Ÿæˆ S3 é¢„ç­¾å URL    â”‚                 â”‚
     â”‚                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                           â”‚                      â”‚                                          â”‚
     â”‚                           â”‚ 6. è¿”å›ä¸‹è½½ URLs      â”‚                                          â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                          â”‚
     â”‚                                                  â”‚                                          â”‚
     â”‚ 7. ç›´æ¥ä» S3 ä¸‹è½½æ–‡ä»¶                             â”‚                                          â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                                                                                              â”‚
     â”‚ 8. æ–‡ä»¶å†…å®¹                                                                                  â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
```

### 3. åŒ…æœç´¢æµç¨‹

```
Conan Client                API Gateway              Lambda                  DynamoDB
     â”‚                           â”‚                      â”‚                        â”‚
     â”‚ 1. GET search?q=pattern   â”‚                      â”‚                        â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                        â”‚
     â”‚                           â”‚ 2. è°ƒç”¨ Lambda        â”‚                        â”‚
     â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
     â”‚                           â”‚                      â”‚ 3. æ‰«æ/æŸ¥è¯¢åŒ…è¡¨        â”‚
     â”‚                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                           â”‚                      â”‚                        â”‚
     â”‚                           â”‚                      â”‚ 4. åŒ¹é…çš„åŒ…åˆ—è¡¨          â”‚
     â”‚                           â”‚                      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                           â”‚                      â”‚                        â”‚
     â”‚                           â”‚ 5. è¿‡æ»¤å’Œè¿”å›ç»“æœ     â”‚                        â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
```

## ğŸ” å®‰å…¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       å®‰å…¨å±‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ä¼ è¾“å±‚å®‰å…¨ (TLS/HTTPS)
   â””â”€ API Gateway å¼ºåˆ¶ HTTPS
   â””â”€ æ‰€æœ‰æ•°æ®ä¼ è¾“åŠ å¯†

2. è®¤è¯ (Authentication)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Bearer Token è®¤è¯                 â”‚
   â”‚  - ç”¨æˆ·ç™»å½•è·å– Token              â”‚
   â”‚  - Token å­˜å‚¨åœ¨ DynamoDB           â”‚
   â”‚  - æ¯æ¬¡è¯·æ±‚éªŒè¯ Token              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. æˆæƒ (Authorization)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)         â”‚
   â”‚  - admin: å®Œå…¨è®¿é—®                â”‚
   â”‚  - user: è¯»å†™è‡ªå·±çš„åŒ…              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. æ•°æ®å±‚å®‰å…¨
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  DynamoDB                          â”‚
   â”‚  - é™æ€åŠ å¯†                        â”‚
   â”‚  - IAM è§’è‰²æƒé™                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  S3                                â”‚
   â”‚  - ç§æœ‰å­˜å‚¨æ¡¶                      â”‚
   â”‚  - é¢„ç­¾å URL (ä¸´æ—¶è®¿é—®)           â”‚
   â”‚  - æœåŠ¡å™¨ç«¯åŠ å¯† (SSE-S3)           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. Lambda å®‰å…¨
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  - æœ€å°æƒé™ IAM è§’è‰²               â”‚
   â”‚  - VPC éš”ç¦» (å¯é€‰)                 â”‚
   â”‚  - ç¯å¢ƒå˜é‡åŠ å¯†                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š DynamoDB è¡¨ç»“æ„

### Packages Metadata è¡¨

```
{
  "packageId": "mylib/1.0@user/channel",      // Partition Key
  "packageName": "mylib",                      // GSI Partition Key
  "version": "1.0",
  "user": "user",
  "channel": "channel",
  "timestamp": 1704067200000,                  // GSI Sort Key
  "files": [
    "conanfile.py",
    "conanmanifest.txt",
    "conan_export.tgz"
  ],
  "packages": {
    "5ab84d6acfe1f23c4fae0ab88f26e3a396351ac9": {
      "settings": {
        "os": "Linux",
        "compiler": "gcc"
      },
      "files": [...]
    }
  }
}
```

**ç´¢å¼•:**
- Primary Index: `packageId`
- Global Secondary Index: `packageName` + `timestamp`

### Users è¡¨

```
{
  "username": "admin",                // Partition Key
  "password": "hashed_password",      // ç”Ÿäº§ç¯å¢ƒåº”è¯¥åŠ å¯†
  "token": "abc123...",               // GSI Partition Key
  "role": "admin",
  "createdAt": 1704067200000,
  "lastLogin": 1704153600000
}
```

**ç´¢å¼•:**
- Primary Index: `username`
- Global Secondary Index: `token`

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### æ°´å¹³æ‰©å±•

```
API Gateway (æ— é™åˆ¶)
     â”‚
     â”œâ”€â–º Lambda Instance 1 (è‡ªåŠ¨æ‰©å±•)
     â”œâ”€â–º Lambda Instance 2
     â”œâ”€â–º Lambda Instance 3
     â””â”€â–º Lambda Instance N
          â”‚
          â”œâ”€â–º DynamoDB (è‡ªåŠ¨æ‰©å±•)
          â””â”€â–º S3 (æ— é™å­˜å‚¨)
```

### æ€§èƒ½ä¼˜åŒ–

1. **Lambda ä¼˜åŒ–**
   - å¢åŠ å†…å­˜åˆ†é… (æ›´å¿«çš„ CPU)
   - é¢„ç•™å¹¶å‘ (é¿å…å†·å¯åŠ¨)
   - ä½¿ç”¨ Lambda å±‚å…±äº«ä¾èµ–

2. **DynamoDB ä¼˜åŒ–**
   - å¯ç”¨ DAX (DynamoDB Accelerator) ç¼“å­˜
   - æŒ‰éœ€è®¡è´¹æˆ–é¢„ç½®å®¹é‡
   - ä½¿ç”¨ GSI ä¼˜åŒ–æŸ¥è¯¢

3. **S3 ä¼˜åŒ–**
   - S3 Transfer Acceleration
   - CloudFront CDN åˆ†å‘
   - å¤šéƒ¨åˆ†ä¸Šä¼ 

### æˆæœ¬ä¼˜åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…è´¹å¥—é¤ä¼°ç®—                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Lambda:                               â”‚
â”‚  - 100 ä¸‡æ¬¡è¯·æ±‚/æœˆ å…è´¹                â”‚
â”‚  - 40 ä¸‡ GB-ç§’ å…è´¹                    â”‚
â”‚                                        â”‚
â”‚  DynamoDB:                             â”‚
â”‚  - 25 GB å­˜å‚¨ å…è´¹                     â”‚
â”‚  - 25 WCU/RCU å…è´¹                     â”‚
â”‚                                        â”‚
â”‚  S3:                                   â”‚
â”‚  - 5 GB å­˜å‚¨ å…è´¹ (å‰ 12 ä¸ªæœˆ)         â”‚
â”‚  - 20,000 GET è¯·æ±‚ å…è´¹                â”‚
â”‚  - 2,000 PUT è¯·æ±‚ å…è´¹                 â”‚
â”‚                                        â”‚
â”‚  API Gateway:                          â”‚
â”‚  - 100 ä¸‡æ¬¡è°ƒç”¨/æœˆ å…è´¹ (å‰ 12 ä¸ªæœˆ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é¢„ä¼°æœˆæˆæœ¬ï¼ˆè¶…å‡ºå…è´¹é¢åº¦åï¼‰:
- å°å‹å›¢é˜Ÿ (< 10 äºº): $1-5/æœˆ
- ä¸­å‹å›¢é˜Ÿ (10-50 äºº): $5-20/æœˆ
- å¤§å‹å›¢é˜Ÿ (50+ äºº): $20-50/æœˆ
```

## ğŸ”„ é«˜å¯ç”¨æ€§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŒºåŸŸçº§åˆ«é«˜å¯ç”¨                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

API Gateway
â”œâ”€ å¤šä¸ªå¯ç”¨åŒº (AZ) è‡ªåŠ¨éƒ¨ç½²
â””â”€ 99.95% SLA

Lambda
â”œâ”€ è‡ªåŠ¨è·¨ AZ å¤åˆ¶
â”œâ”€ è‡ªåŠ¨é‡è¯•å¤±è´¥çš„è°ƒç”¨
â””â”€ 99.95% SLA

DynamoDB
â”œâ”€ æ•°æ®è‡ªåŠ¨è·¨ 3 ä¸ª AZ å¤åˆ¶
â”œâ”€ è‡ªåŠ¨æ•…éšœè½¬ç§»
â””â”€ 99.99% SLA

S3
â”œâ”€ å¯¹è±¡è‡ªåŠ¨è·¨ AZ å¤åˆ¶
â”œâ”€ 11 ä¸ª 9 çš„æŒä¹…æ€§ (99.999999999%)
â””â”€ 99.99% SLA
```

## ğŸ› ï¸ æ•…éšœæ¢å¤

### è‡ªåŠ¨æ¢å¤æœºåˆ¶

1. **Lambda å¤±è´¥é‡è¯•**
   - è‡ªåŠ¨é‡è¯• 2 æ¬¡
   - æŒ‡æ•°é€€é¿ç­–ç•¥

2. **DynamoDB å¤‡ä»½**
   - å¯ç”¨æ—¶é—´ç‚¹æ¢å¤ (PITR)
   - å¯æ¢å¤åˆ°è¿‡å» 35 å¤©å†…ä»»æ„æ—¶é—´ç‚¹

3. **S3 ç‰ˆæœ¬æ§åˆ¶**
   - å¯ç”¨ç‰ˆæœ¬æ§åˆ¶é˜²æ­¢æ„å¤–åˆ é™¤
   - å¯æ¢å¤å†å²ç‰ˆæœ¬

### ç¾éš¾æ¢å¤

```
ä¸»åŒºåŸŸ (ap-east-1)              å¤‡ä»½åŒºåŸŸ (us-east-1)
       â”‚                               â”‚
       â”‚                               â”‚
   DynamoDB â”€â”€â”€â”€â”€â”€å¤åˆ¶â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º DynamoDB
       â”‚       (å¯é€‰)                  â”‚
       â”‚                               â”‚
       S3 â”€â”€â”€â”€â”€â”€â”€â”€â”€å¤åˆ¶â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º S3
           (è·¨åŒºåŸŸå¤åˆ¶)
```

## ğŸ“ˆ ç›‘æ§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CloudWatch                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–²              â–²              â–²
           â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
    â”‚  Metrics â”‚   â”‚   Logs   â”‚   â”‚  Alarms  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–²              â–²              â”‚
           â”‚              â”‚              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Lambda / API GW       â”‚   â”‚   SNS   â”‚
    â”‚    DynamoDB / S3         â”‚   â”‚  é€šçŸ¥   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç›‘æ§æŒ‡æ ‡:
- API è¯·æ±‚æ•°å’Œå»¶è¿Ÿ
- Lambda é”™è¯¯ç‡å’Œè¶…æ—¶
- DynamoDB è¯»å†™å®¹é‡
- S3 å­˜å‚¨ä½¿ç”¨é‡
- è®¤è¯å¤±è´¥æ¬¡æ•°
```

## ğŸ”® æœªæ¥å¢å¼º

1. **æ€§èƒ½å¢å¼º**
   - CloudFront CDN
   - ElastiCache Redis ç¼“å­˜
   - Lambda@Edge è¾¹ç¼˜è®¡ç®—

2. **åŠŸèƒ½å¢å¼º**
   - Web UI ç®¡ç†ç•Œé¢
   - ä½¿ç”¨é‡åˆ†æå’ŒæŠ¥è¡¨
   - åŒ…ä¾èµ–å…³ç³»å›¾
   - å¤šç§Ÿæˆ·æ”¯æŒ

3. **å®‰å…¨å¢å¼º**
   - AWS WAF é˜²æŠ¤
   - Secrets Manager å¯†é’¥ç®¡ç†
   - å®¡è®¡æ—¥å¿— (CloudTrail)
   - VPC ç§æœ‰ç½‘ç»œ

4. **é›†æˆå¢å¼º**
   - CI/CD æµæ°´çº¿é›†æˆ
   - Slack/Teams é€šçŸ¥
   - GitHub/GitLab é›†æˆ
   - å¤šäº‘æ”¯æŒ

è¿™ä¸ªæ¶æ„æä¾›äº†ä¸€ä¸ªå¯æ‰©å±•ã€é«˜å¯ç”¨ã€æˆæœ¬ä¼˜åŒ–çš„ serverless Conan Server è§£å†³æ–¹æ¡ˆï¼
